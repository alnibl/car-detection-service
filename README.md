# Car Detection Service

Веб-сервис для обнаружения автомобилей на изображениях с использованием YOLO.

## Оглавление

- [Настройка окружения](#настройка-окружения)
- [Установка зависимостей](#установка-зависимостей)
- [Запуск сервиса](#запуск-сервиса)
- [Команды](#команды)
- [Docker](#docker)
- [Тестирование](#тестирование)

---

## Настройка окружения

1. Создайте и активируйте виртуальное окружение:

   ```bash
   python3 -m venv venv
   source venv/bin/activate  # Для Linux/MacOS
   # venv\Scripts\activate    # Для Windows
   ```

2. Установите зависимости:

   ```bash
   make install
   ```

---

## Установка зависимостей

Для установки всех необходимых библиотек выполните:

```bash
make install
```

---

## Запуск сервиса

### Локальный запуск

Чтобы запустить сервис локально, выполните:

```bash
make run
```

Сервис будет доступен по адресу: [http://127.0.0.1:8000](http://127.0.0.1:8000).

### Запуск с Docker

1. Соберите Docker-образ:

   ```bash
   make build
   ```

2. Запустите контейнер на CPU:

   ```bash
   make run-docker
   ```

3. Запустите контейнер на GPU (требуется NVIDIA Docker):

   ```bash
   make run-docker-gpu
   ```

---

## Команды

Основные команды для управления проектом:

| Команда              | Описание                                      |
|----------------------|-----------------------------------------------|
| `make install`       | Установка зависимостей                        |
| `make run`           | Запуск сервиса локально                       |
| `make build`         | Сборка Docker-образа                          |
| `make run-docker`    | Запуск Docker-контейнера на CPU               |
| `make run-docker-gpu`| Запуск Docker-контейнера на GPU               |
| `make test`          | Запуск тестов                                 |
| `make clean`         | Удаление Docker-образов                       |
| `make help`          | Показать справку по всем командам             |

---

## Docker

### Сборка образа

Соберите Docker-образ с помощью команды:

```bash
make build
```

### Запуск контейнера

- Для запуска на CPU:

  ```bash
  make run-docker
  ```

- Для запуска на GPU (требуется NVIDIA Docker):

  ```bash
  make run-docker-gpu
  ```

---

## Тестирование

Для запуска тестов выполните:

```bash
make test
```

---

## Переменные окружения

Сервис поддерживает следующие переменные окружения:

| Переменная | Описание                          | Значение по умолчанию |
|------------|-----------------------------------|-----------------------|
| `DEVICE`   | Устройство для выполнения inference (`cpu` или `cuda`) | `cpu` |
| `HOST`     | Хост для запуска сервера          | `0.0.0.0`             |
| `PORT`     | Порт для запуска сервера          | `8000`                |

Пример запуска с GPU:

```bash
docker run --gpus all -e DEVICE=cuda -p 8000:8000 car-detection
```